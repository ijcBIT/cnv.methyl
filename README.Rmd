---
title: "cnv-methyl manual: dynamic Somatic Copy Nunmber Alterations for methylation array data."
subtitle: "A dynamic thresholding implementation of conumee."
author: "Izar de Villasante"
date: "`r format(Sys.time(), '%d %B %Y')`"
tags: [CNV,cnv,scna,SCNA,methylation,cnv-methyl,conumee,automatic-thresholding,automatic,thresholding,dynamic,array,methyl-array,450K,EPIC,epic,450k]
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# Manual:

<!-- badges: start -->
<!-- badges: end -->

The goal of cnv.methyl is to ...

## Installation

You can install the development version of cnv.methyl from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("izarvillasante/cnv.methyl")
```

## Example

This is a basic example which shows you how to get somatic copy number 
alterations using the pre-calculated constant used in the paper [Blecua,P et al.](https://academic.oup.com/bib).
First load your targets sample sheet:

```{r samplesheet}
sample_sheet<-utils::read.csv(system.file("extdata", "Sample_sheet_example.csv",package="cnv.methyl"))
str(sample_sheet)
head(sample_sheet)
```

The main function is `run_cnv.methyl` that will perform the whole pipline from idats to GRanges object with gene and copy number alteration annotations:
```{r main function,cache=TRUE}
library(cnv.methyl)
out="analysis/example/"
gr_list<-run_cnv.methyl(targets = sample_sheet,arraytype = "450K",Kc = "curated", out=out)
gr_list
```


If you wish to combine 450K and epic arrays you can use the variable `arraytype = overlap` 
Here is an example using the pre-processed data from the previous code chunk:
**Important: don't forget to load the right sample sheet with the purities. This file will be in *"path-to-out-folder/Sample_Sheet.txt"***

```{r overlapping arraytypes}
library(cnv.methyl)
out="analysis/example/"
ss<-data.table::fread(paste0(out,"Sample_Sheet.txt"))
ID <- ss$Sample_Name[1]
ss <- ss[Sample_Name==ID,]
cna<-Kc_get(ss=ss,ID=ID,arraytype = "overlap")
cna

## basic example code
```
